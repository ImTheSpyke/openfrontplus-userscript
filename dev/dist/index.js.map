{"version":3,"file":"index.js","sourceRoot":"/","sources":["index.ts"],"names":[],"mappings":"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","sourcesContent":["import WebSocket from \"ws\";\r\nimport * as Types from \"./types/index\";\r\nimport fs from \"fs\";\r\n\r\n\r\nconst gameID = \"PiUNqm6v\";\r\n\r\nfunction simpleHash(str:string) {\r\n    let hash = 0;\r\n    for (let i = 0; i < str.length; i++) {\r\n      const char = str.charCodeAt(i);\r\n      hash = (hash << 5) - hash + char;\r\n      hash = hash & hash; // Convert to 32-bit integer\r\n    }\r\n    return Math.abs(hash);\r\n}\r\n\r\nfunction timePrefix() {\r\n    let d = new Date();\r\n    return `[${d.toISOString()}]`;\r\n}\r\n\r\n/*\r\nfunction tileToCoordinates(tile: number, width: number, height: number): { x: number; y: number } {\r\n    if (tile < 0 || tile >= width * height) {\r\n        throw new Error(\"Tile index out of bounds\");\r\n    }\r\n\r\n    const x = tile % width;\r\n    const y = Math.floor(tile / width);\r\n\r\n    return { x, y };\r\n}\r\n    */\r\n\r\nlet workerID = simpleHash(gameID) % 20\r\n\r\nconsole.log(\"Worker ID:\", workerID);\r\n\r\nconst URL = \"wss://openfront.io/w\" + workerID;\r\n\r\nconst ws = new WebSocket(URL);\r\n\r\nws.on(\"open\", () => {\r\n    console.log(\"Connected to\", URL);\r\n    ws.send(JSON.stringify({\"type\":\"join\",\"gameID\":gameID,\"clientID\":\"aabjiThQ\",\"lastTurn\":0,\"token\":\"c40aeb8d-8d43-43c8-ad76-08ec3102212c\",\"username\":\"ImTheSpyke\",\"cosmetics\":{\"flag\":\"ch\"}}))\r\n\r\n    pingInterval = setInterval(() => {\r\n        ws.send(JSON.stringify({\"type\":\"ping\"}));\r\n    }, 5000);\r\n});\r\n\r\n\r\nlet pingInterval: NodeJS.Timeout|null = null;\r\n\r\nfunction turnNumToTime(turnNum: number): string {\r\n    // turnNum = 0.1s\r\n    const totalSeconds = Math.floor(turnNum / 10);\r\n    const minutes = Math.floor(totalSeconds / 60);\r\n    const seconds = totalSeconds % 60;\r\n    return `${minutes}m ${seconds}s`;\r\n}\r\n\r\nif(turnNumToTime(1490) !== \"2m 29s\") {\r\n}\r\n\r\nws.on(\"message\", (message: Buffer) => {\r\n    let msg: Types.Openfront.Message = JSON.parse(message.toString()) as any\r\n\r\n    //console.log(`${msg.type} message received.`,msg);\r\n    \r\n\r\n    if(msg.type === \"error\") {\r\n        console.error(\"Error message received:\", Buffer.from(msg.message).toString());\r\n    }\r\n\r\n    if(msg.type === \"turn\"){\r\n        // console.log(`[${turnNumToTime(msg.turn.turnNumber)}] Turn:`, JSON.stringify(msg,null,2));\r\n\r\n        processTurn(msg.turn);\r\n    }\r\n\r\n    if(msg.type === \"start\"){\r\n        console.log(\"Game started with\", msg.gameStartInfo.players.length, \"players.\");\r\n        msg.gameStartInfo.players.forEach((player) => {\r\n            if(LOGS.players.findIndex(p => p.id === player.clientID) === -1) {\r\n                LOGS.players.push({\r\n                    id: player.clientID,\r\n                    username: player.username,\r\n                    connected: true\r\n                });\r\n            } else {\r\n                const playerIndex = LOGS.players.findIndex(p => p.id === player.clientID);\r\n                LOGS.players[playerIndex].connected = true;\r\n                LOGS.players[playerIndex].username = player.username;\r\n            }\r\n        });\r\n    }\r\n\r\n    if(LOGS.debug.messageTypes.indexOf(msg.type) === -1) {\r\n        LOGS.debug.messageTypes.push(msg.type);\r\n    }\r\n});\r\n\r\nws.on(\"close\", () => {\r\n  console.log(\"Connection closed\");\r\n    clearInterval(pingInterval as NodeJS.Timeout);\r\n});\r\n\r\nws.on(\"error\", (err: Error) => {\r\n  console.error(\"WebSocket error:\", err);\r\n});\r\n\r\n\r\nconst LOGS: Types.LOGS = {\r\n    \"attacks\": [],\r\n    \"players\": [],\r\n    \"debug\": {\r\n        \"units\": [],\r\n        messageTypes: [],\r\n        builds: [],\r\n        alliances: []\r\n    }\r\n}\r\n\r\nconsole.log(LOGS);\r\n\r\n\r\nfunction logToFilename(fileName:string, data: string) {\r\n    fs.writeFileSync(`logs/${fileName}`, data);\r\n}\r\nfunction appendToFilename(fileName:string, data: string) {\r\n    fs.appendFileSync(`logs/${fileName}`, data);\r\n}\r\n\r\nfunction numToKMB(num: number): string {\r\n    if(num >= 1_000_000_000) {\r\n        return (num / 1_000_000_000).toFixed(1) + \"B\";\r\n    } else if(num >= 1_000_000) {\r\n        return (num / 1_000_000).toFixed(1) + \"M\";\r\n    } else if(num >= 1_000) {\r\n        return (num / 1_000).toFixed(1) + \"k\";\r\n    } else {\r\n        return num.toFixed(0);\r\n    }\r\n}\r\n\r\nfunction getPlayerFromID(id: string) {\r\n    return LOGS.players.find(p => p.id === id);\r\n}\r\n\r\nfunction processTurn(turnData: Types.Openfront.Message_Turn[\"turn\"]) {\r\n\r\n    // console.log(`${turnNumToTime(turnData.turnNumber)} - Processing turn ${turnData.turnNumber} with ${turnData.intents.length} intents.`);\r\n\r\n    turnData.intents.forEach((intent) => {\r\n        if(intent.type === \"attack\") {\r\n            LOGS.attacks.push({\r\n                turn: turnData.turnNumber,\r\n                attacker: intent.clientID,\r\n                troops: intent.troops,\r\n                troopsTxt: numToKMB(intent.troops),\r\n                victim: intent.targetID as string\r\n            });\r\n        }\r\n        if(intent.type === \"build_unit\") {\r\n            LOGS.debug.builds.push({\r\n                turn: turnData.turnNumber,\r\n                builder: intent.clientID,\r\n                unit: intent.unit,\r\n                tile: intent.tile\r\n            });\r\n        }\r\n    });\r\n\r\n    turnData.intents.forEach((intent) => {\r\n        const playerIndex = LOGS.players.findIndex(p => p.id === intent.clientID);\r\n        if(playerIndex === -1) {\r\n            LOGS.players.push({\r\n                id: intent.clientID,\r\n                username: null,\r\n                connected: true\r\n            });\r\n        } else {\r\n            LOGS.players[playerIndex].connected = true;\r\n        }\r\n    });\r\n\r\n    turnData.intents.forEach((intent) => {\r\n        processIntent(intent);\r\n        if(intent.type === \"mark_disconnected\") {\r\n            const playerIndex = LOGS.players.findIndex(p => p.id === intent.clientID);\r\n            if(playerIndex !== -1) {\r\n                LOGS.players[playerIndex].connected = !intent.isDisconnected;\r\n            }\r\n        }\r\n    });\r\n\r\n    logToFilename(\"attacks.json\", JSON.stringify(LOGS.attacks, null, 2));\r\n    logToFilename(\"players.json\", JSON.stringify(LOGS.players, null, 2));\r\n    logToFilename(\"debug.json\", JSON.stringify(LOGS.debug, null, 2));\r\n}\r\n\r\n\r\nfunction processIntent(intent: Types.Openfront.Intent) {\r\n    \r\n    appendToFilename(\"all_intents.log\", `${timePrefix()} [${intent.type}] from ${intent.clientID}: ${JSON.stringify(intent)}\\n`);\r\n    if(intent.clientID == \"WDj2e1K6\") {\r\n        console.log(`${timePrefix()} ${intent.type} intent from ${intent.clientID}`, intent);\r\n    }\r\n\r\n    if(intent.type == \"allianceRequest\") {\r\n        let text = `${timePrefix()} [${intent.type}] ${intent.clientID} asked ${intent.recipient} (${getPlayerFromID(intent.clientID)?.username || \"Unknown\"} asked ${getPlayerFromID(intent.recipient)?.username || \"Unknown\"})`\r\n        console.log(text);\r\n        appendToFilename(\"alliances.log\", text + \"\\n\");\r\n    } else if(intent.type == \"allianceRequestReply\") {\r\n        let text = `${timePrefix()} [${intent.type}] ${intent.clientID} accepted ${intent.requestor} (${getPlayerFromID(intent.clientID)?.username || \"Unknown\"} accepted ${getPlayerFromID(intent.requestor)?.username || \"Unknown\"})`\r\n        appendToFilename(\"alliances.log\", text + \"\\n\");\r\n        if(intent.accept == true) {\r\n            console.log(text);\r\n            LOGS.debug.alliances.push({\r\n                players: [\r\n                    intent.clientID,\r\n                    intent.requestor\r\n                ],\r\n                expiresAt: Date.now() + 1000 * 60 * 5,\r\n                createdAt: Date.now(),\r\n                createdAtText: (new Date()).toISOString()\r\n            });\r\n        }\r\n        appendToFilename(\"alliances.log\", `${timePrefix()} Alliances of now are: ${JSON.stringify(LOGS.debug.alliances)}\\n`);\r\n    } else if(intent.type == \"breakAlliance\") {\r\n        appendToFilename(\"alliances.log\", `${timePrefix()} [${intent.type}] ${intent.clientID} broke alliance with ${intent.recipient}\\n`);\r\n        LOGS.debug.alliances = LOGS.debug.alliances.filter((alliance:any) => {\r\n            let isThisTheirAlliance = (alliance.players[0] == intent.clientID && alliance.players[1] == intent.recipient)\r\n                                   || (alliance.players[0] == intent.recipient && alliance.players[1] == intent.clientID); \r\n            return !isThisTheirAlliance;\r\n        })\r\n        appendToFilename(\"alliances.log\", `${timePrefix()} Alliances of now are: ${JSON.stringify(LOGS.debug.alliances)}\\n`);\r\n    } else if(intent.type == \"allianceExtension\") {\r\n        appendToFilename(\"alliances.log\", `${timePrefix()} [${intent.type}] ${intent.clientID} extended alliance with ${intent.recipient}\\n`);\r\n        appendToFilename(\"alliances.log\", `${timePrefix()} Alliances of now are: ${JSON.stringify(LOGS.debug.alliances)}\\n`);\r\n    }\r\n\r\n}\r\n\r\nfunction display(items: string[], width = 3, gap = 2) {\r\n  if (!Array.isArray(items)) throw new TypeError(\"items must be an array\");\r\n  if (!Number.isInteger(width) || width <= 0) throw new TypeError(\"width must be a positive integer\");\r\n\r\n  const gapStr = typeof gap === \"number\" ? \" \".repeat(Math.max(0, gap)) : String(gap);\r\n\r\n  const rows = Math.ceil(items.length / width);\r\n\r\n  // Build grid\r\n  const grid = Array.from({ length: rows }, (_, r) =>\r\n    Array.from({ length: width }, (_, c) => {\r\n      const idx = r * width + c;\r\n      return idx < items.length ? String(items[idx]) : \"\";\r\n    })\r\n  );\r\n\r\n  // Compute column widths\r\n  const colWidths = Array.from({ length: width }, (_, c) =>\r\n    Math.max(...grid.map(row => (row[c] || \"\").length))\r\n  );\r\n\r\n  const padRight = (str: string, len: number) => str + \" \".repeat(Math.max(0, len - str.length));\r\n\r\n  // Build lines into a string\r\n  const lines = grid.map(row => {\r\n    let line = \"\";\r\n    for (let c = 0; c < width; c++) {\r\n      const cell = row[c] || \"\";\r\n      const padded = padRight(cell, colWidths[c]);\r\n      line += padded + (c === width - 1 ? \"\" : gapStr);\r\n    }\r\n    return line.trimEnd();\r\n  });\r\n\r\n  return lines.join(\"\\n\");\r\n}\r\n\r\nfunction formatTime(msTime: number, format:string=\"HH:mm:ss\") {\r\n        // 1000 -> \"00:01\" \r\n        // 60000 -> \"01:00\"\r\n        // 3600000 -> \"01:00:00\"\r\n\r\n        let hours = Math.floor(msTime / 3600000).toString().padStart(2, '0');\r\n        let minutes = Math.floor((msTime % 3600000) / 60000).toString().padStart(2, '0');\r\n        let seconds = Math.floor((msTime % 60000) / 1000).toString().padStart(2, '0');\r\n\r\n        let toFormatString = format.replace('HH', hours).replace('mm', minutes).replace('ss', seconds);\r\n        return toFormatString;\r\n}\r\n\r\nfunction displayAllianceCountdown() {\r\n    // Filter out expired alliances\r\n    let now = Date.now();\r\n    LOGS.debug.alliances = LOGS.debug.alliances.filter((alliance:any) => {\r\n        if(alliance.expiresAt < now) {\r\n            return false;\r\n        }\r\n        return true;\r\n    });\r\n\r\n    // Sort by expiresAt\r\n\r\n    let now2 = Date.now();\r\n    let to_display = LOGS.debug.alliances.map((alliance:any) => {\r\n        let expiresIn = (alliance.expiresAt - now2);\r\n        return `(${formatTime(expiresIn, \"mm:ss\")}) ${getPlayerFromID(alliance.players[0])?.username || \"Unknown\"} - ${getPlayerFromID(alliance.players[1])?.username || \"Unknown\"}`;\r\n    })\r\n\r\n    console.log(\"\\n\\n\\n\")\r\n    let alliance_countdown = display(to_display, 6, 2);\r\n\r\n    console.log(alliance_countdown);\r\n\r\n    logToFilename(\"alliances_countdown.log\", alliance_countdown);\r\n}\r\n\r\n\r\nsetInterval(() => {\r\n    displayAllianceCountdown()\r\n}, 1000)\r\n\r\n/*\r\n\r\n  \"type\": \"turn\",\r\n  \"turn\": {\r\n    \"turnNumber\": 1490,\r\n    \"intents\": [\r\n      {\r\n        \"clientID\": \"KPeo8z5m\",\r\n        \"type\": \"attack\",\r\n        \"targetID\": \"af3ud7py\",\r\n        \"troops\": 140911.75\r\n      },\r\n      {\r\n        \"clientID\": \"Ahvq5vdn\",\r\n        \"type\": \"attack\",\r\n        \"targetID\": \"ehrmygu3\",\r\n        \"troops\": 197686.19999999998\r\n      }\r\n    ]\r\n  }\r\n}\r\n\r\n*/\r\n\r\n/*\r\n\r\n// ==UserScript==\r\n// @name         OpenfrontIO+\r\n// @namespace    http://openfront.io/\r\n// @version      2025-11-20\r\n// @description  A\r\n// @author       You\r\n// @match        *://openfront.io/*\r\n// @grant        none\r\n// ==/UserScript==\r\n\r\n(function() {\r\n    'use strict';\r\n    \r\n    \r\n    const tableUI = {\r\n        toggleDisplay: (show) => {\r\n            let table = document.querySelector(\"leader-board\")\r\n            let button = document.querySelector(\"game-left-sidebar > aside > div > div\")\r\n            let shouldShow = show == true && table.textContent.trim() == \"\" || show == false && table.textContent.trim() != \"\"\r\n            if(shouldShow){\r\n                button.click()\r\n            }\r\n        },\r\n        expand: (expand) => {\r\n            let button = document.querySelector(\"leader-board > button\")\r\n            let shouldClick = expand == true && button.textContent.trim() == \"+\" || expand == false && button.textContent.trim() == \"-\"\r\n            if(shouldClick){\r\n                button.click()\r\n            }\r\n            return shouldClick\r\n        }\r\n    }\r\n\r\n    tableUI[\"expandAll\"] = () => {\r\n        tableUI.toggleDisplay(true)\r\n        setTimeout(() => {\r\n            tableUI.expand(true)\r\n        }, 20)\r\n    }\r\n\r\n\r\n    function textFormatedToInt(goldStr) {\r\n        // 100k -> 100000\r\n        // 2.5M -> 2500000\r\n        // 1.2B -> 1200000000\r\n        \r\n        let multipliers = {\r\n            'K': 1e3,\r\n            'M': 1e6,\r\n            'B': 1e9,\r\n        }\r\n        let multiplier = multipliers[goldStr.slice(-1)]\r\n        return parseInt(goldStr.slice(0, -1)) * multiplier\r\n    }\r\n\r\n    function getScoreboardPlayersDats() {\r\n        let table = [...document.querySelector(\"leader-board > div > div\").children]\r\n        // remove first row (header)\r\n        table.shift()\r\n\r\n        let players = table.map(row => {\r\n            let cols = [...row.children].map(col => col.textContent.trim())\r\n            return {\r\n                username: cols[1],\r\n                percent: parseFloat(cols[2]).toFixed(1),\r\n                gold: textFormatedToInt(cols[3]),\r\n                troops: textFormatedToInt(cols[4]),\r\n            }\r\n        })\r\n        return players\r\n    }\r\n\r\n    function \r\n\r\n    // Your code here...\r\n})();\r\n*/"]}